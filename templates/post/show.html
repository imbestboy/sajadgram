{% extends '../base.html' %}


{% block title %}
Post
{% endblock title %}

{% block content-header %}
{% endblock content-header %}


{% block content %}
{% csrf_token %}
<div class="col-md-8 col-sm-12 col-lg-5">
    <div class="card card-widget">
        <div class="card-header">
            <div class="user-block">
                <img class="img-circle img-fluid" src="{{post.user.profile_photo.url}}" alt="User Image">
                <span class="username"><a
                        href="{% url 'account:profile' username=post.user.username %}">{{post.user.username}}</a></span>
                <span class="description">{{post.created_time}}</span>
            </div>
        </div>
        <div class="card-body">
            <img class="img-fluid pad" src="{{post.media.url}}" alt="Photo">

            <p class="mt-2">{{post.caption}}</p>
            <button type="button" class="btn btn-default btn-sm" id="save">

                {% if is_saved %}
                <i class="fas text-primary fa-bookmark nav-icon"></i> Saved
                {% else %}
                <i class="far fa-bookmark nav-icon"></i> Save
                {% endif %}
            </button>
            <button type="button" class="btn btn-default btn-sm" id="like">
                {% if is_liked %}
                <i class="fas fa-thumbs-up text-primary"></i> Liked
                {% else %}
                <i class="far fa-thumbs-up"></i> Like
                {% endif %}
            </button>
            <span class="float-right text-muted"><span id="liked_count">{{liked_count}}</span> likes - 3 comments</span>
        </div>
        <!-- <div class="card-footer">
        <form enctype="multipart/form-data" method="post">
            <img class="img-fluid img-circle img-sm" src="../dist/img/user4-128x128.jpg" alt="Alt Text">
            <div class="img-push">
                <input type="text" class="form-control form-control-sm" placeholder="Press enter to post comment">
            </div>
        </form>
    </div> -->
    </div>
</div>

{% endblock content %}


{% block end-body %}

<script>
    $("#save").click(function () {
        $.ajax({
            url: "{% url 'post:save' %}",
            type: 'post',
            data: JSON.parse('{"display_name":"{{post.display_name}}"}'),
            success: function (data) {
                if (data === "True") {
                    $("#save").html('<i class="fas text-primary fa-bookmark nav-icon"></i> Saved')
                } else {
                    $("#save").html('<i class="far fa-bookmark nav-icon"></i> Save')
                }
            }
        });
    });
    $("#like").click(function () {
        $.ajax({
            url: "{% url 'post:like' %}",
            type: 'post',
            data: JSON.parse('{"display_name":"{{post.display_name}}"}'),
            success: function (data) {
                if (data === "True") {
                    $("#like").html('<i class="fas fa-thumbs-up text-primary"></i> Liked')
                    var liked_count = Number($("#liked_count").text())
                    $("#liked_count").text(String(++liked_count))
                } else {
                    $("#like").html('<i class="far fa-thumbs-up"></i> Like')
                    var liked_count = Number($("#liked_count").text())
                    $("#liked_count").text(String(--liked_count))
                }
            }
        });

    });
</script>
{% endblock end-body %}